<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <style>
        #Container{
            border: 1px solid black;
            width: 300px;
            padding: 10px;
            margin-bottom: 20px;
        }
        .card{
            border: 1px solid rgb(105, 31, 31);
            padding: 10px;
            margin: 10px;
            display: inline-block;
            vertical-align: top;
        }
        #formDiv{
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h2>Fleet Dashboard</h2>
    <!-- navbar -->
    <select  id="filterCategory">
        <option value="all">All Vehicles</option>
        <option value="trucks">Trucks</option>
        <option value="vans">Vans</option>
        <option value="cars">Cars</option>
        <option value="bus">Bus</option>

    </select>
    <select id="filterAvailability">
        <option> All</option>
        <option> Available</option>
        <option> Unavailable</option>
    </select>
    <button id="clearFilter">Clear Filter</button>
    <hr>

    <div id="Container">
        <div id="formDiv">
            <h3>Add Fleet</h3>
            <input type="text" id="reg" placeholder="Reg No"/><br><br>
            <select  id="cat">
                <option value="all">All Vehicles</option>
                <option value="trucks">Trucks</option>
                <option value="vans">Vans</option>
                <option value="cars">Cars</option>
                <option value="bus">Bus</option>
            </select>
            <input type="text" id="driver" placeholder="Driver Name"/><br><br>
            <select id="Avail">
                <option> All</option>
                <option> Available</option>
                <option> Unavailable</option>
            </select><br><br>
            <button id="addBtn">Add Fleet</button>
        </div>
        <div id="cards"></div>
    </div>

    <script>
        let data = [];

        document.getElementById('addBtn').addEventListener('click', function() {
            const reg = document.getElementById('reg').value;
            const cat = document.getElementById('cat').value;
            const driver = document.getElementById('driver').value;
            const avail = document.getElementById('avail').value;

            if (!reg || !driver) {
                alert('Required fields cannot be empty');
                return;
            }
            let obj = {reg, cat, driver, avail};
            data.push(obj);

            document.getElementById('reg').value = '';
            document.getElementById('driver').value = '';

            render(data);
        });

        function render(arr){
            document.getElementById('cards').innerHTML = '';
            arr.forEach((item,index) => {
                let card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <img src="https://coding-platform.s3.amazonaws.com/dev/lms/tickets/5e80fcb6-3f8e-480c-945b-30a5359eb40e/JNmYjkVr3WOjsrbu.png" alt="Vehicle Image"/><br>
                    <h4>Reg No: ${item.reg}</h4>
                    <p>Category: ${item.cat}</p>
                    <p>Driver: ${item.driver}</p>
                    <p>Availability: ${item.avail}</p>
                    <button id="updateDriver${index}">Update Driver</button>
                    <button id="changeAvail${index}">Change Availability</button>
                    <button id="del${index}">Delete</button>
                `;
                document.getElementById('cards').appendChild(card);
            });
        }
        function updateDriver(i){
            let newDriver = prompt("Enter new driver name:");
            if(newDriver && newDriver.trim() !== ""){
                data[i].driver = newDriver;
                render(data);
            }else{
                alert("Driver name cannot be empty");
            }
        }
        function changeAvail(i){
            data[i].avail = data[i].avail === "Available" ? "Unavailable" : "Available";
            render(data);
        }
        function del(i){
            if(confirm("Are you sure you want to delete this entry?"))
            {
                data.splice(i,1);
                render(data);
            }
        }
        function editFleet(i){
            let newReg = prompt("Enter new registration number:", data[i].reg);
            let newCat = prompt("Enter new category:", data[i].cat);
            let newDriver = prompt("Enter new driver name:", data[i].driver);
            let newAvail = prompt("Enter new availability (Available/Unavailable):", data[i].avail);

            if (!newReg || !newDriver){
                alert('Required fields cannot be empty');
                return;
            }

            data[i] = {
                reg: newReg,
                cat: newCat,
                driver: newDriver,
                avail: newAvail
            };
            render(data);
        }

        document.getElementById("filterCategory").addEventListener("change", applyFilters);
        document.getElementById("filterAvailability").addEventListener("change", applyFilters);
        document.getElementById("clearFilter").addEventListener("click", () => {
            document.getElementById("filterCategory").value = "All";
            document.getElementById("filterAvailability").value = "All";
            render(data);
        });
        function applyFilter(){
            let c = document.getElementById("filterCategory").value;
            let a = document.getElementById("filterAvailability").value;

            let filtered = data.filter(item => {
                return (c === "All" || item.cat === c) && (a === "All" || item.avail === a);
            });
            render(filtered);
        }

    </script>
    
    
</body>
</html>